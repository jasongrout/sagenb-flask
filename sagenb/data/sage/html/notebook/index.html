{% extends "html/base.html" %}
 {#
 INPUT:
 - worksheet - an instance of Worksheet
 - worksheet_filename - a string containing a worksheet's filename
 - notebook - an instance of Notebook which contains worksheet
 - username  - a string containing a username
 - show_debug - a boolean stating whether to show debug information
 - JSMATH - a boolean stating whether to include jsMath
 - JSMATH_IMAGE_FONTS - a boolean stating whether to include jsMath iamage fonts
 - JEDITABLE_TINYMCE - a boolean stating whether to include jEditable and TinyMCE
 - sage_jsmath_macros - an array containing strings of Javascript of Sage macros for jsMath
 - do_print - a boolean stating whether the file is for print mode
 - worksheet_html - a string containing the html for a worksheet
 - select    - a string containing the control that is selected
 - backwards - a boolean
 - warn - boolean stating whether to warn that another user is viewing
          the worksheet
#}

{% if not select %}
    {% set select = none %}
{% endif %}

{% if not backwards %}
    {% set backwards = false %}
{% endif %}
    
{% include "html/notebook/head.tmpl"%}

{% block title %}
{{ common_title(worksheet_filename, worksheet) }}
{% endblock %}
    
{% block css %}main{% endblock %}

{% block javascript %}
{{ common_javascript(worksheet, worksheet_filename, username, JSMATH, JEDITABLE_TINYMCE) }}
{% endblock %}

{# TODO: Hack until the template restructuring #}
{% block body_attrs %}
{% if worksheet.is_published() or notebook.user_is_guest(username) %}
        class="worksheet-online" onLoad="initialize_the_notebook();"
    {% else %}
        class="worksheet-online" onLoad="initialize_the_notebook();" id="user-worksheet-index"
{% endif %}
{% endblock %}


{% block body %}
{% if worksheet.is_published() or notebook.user_is_guest(username) %}
    {% set original_worksheet = worksheet.worksheet_that_was_published() %}
    {% include "html/notebook/guest_top_bar_and_worksheet.html" %}
{% else %}
    {% include "html/notebook/top_bar_and_worksheet.html" %}
{% endif %}
{% if not worksheet %}
    </td></tr></table></span>
{% endif %}
{% if worksheet.is_only_viewer(username) %}
    <script type="text/javascript">worksheet_locked=true;</script>
{% else %}
    <script type="text/javascript">worksheet_locked=false;</script>
{% endif %}
{% if worksheet.computing() %}
    <!-- Set the update checking back in motion. -->
    <script type="text/javascript">
        active_cell_list = {{ worksheet.queue_id_list() }};
        for(var i = 0; i < active_cell_list.length; i++) {
            cell_set_running(active_cell_list[i]);
        }
        start_update_check();
    </script>
{% endif %}
{% endblock %}
